<!doctype html>
<html lang="ar" dir="rtl" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ù„Ø¹Ø¨Ø© Ù†Ø¨Ø¶ Ø§Ù„Ø°Ø§ÙƒØ±Ø©</title>
  <script src="https://cdn.tailwindcss.com/3.4.17"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&amp;display=swap" rel="stylesheet">
  <style>
    * { font-family: 'Tajawal', sans-serif; }
    
    @keyframes pulse-glow {
      0%, 100% { transform: scale(1); box-shadow: 0 0 0 0 currentColor; }
      50% { transform: scale(1.08); box-shadow: 0 0 30px 10px currentColor; }
    }
    
    @keyframes wrong-shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-8px); }
      75% { transform: translateX(8px); }
    }
    
    @keyframes success-bounce {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.15); }
    }
    
    .btn-pulse {
      animation: pulse-glow 0.5s ease-in-out;
    }
    
    .btn-wrong {
      animation: wrong-shake 0.4s ease-in-out;
    }
    
    .btn-success {
      animation: success-bounce 0.3s ease-in-out;
    }
    
    .game-btn {
      transition: all 0.15s ease;
    }
    
    .game-btn:hover:not(:disabled) {
      transform: scale(1.05);
    }
    
    .game-btn:active:not(:disabled) {
      transform: scale(0.95);
    }
    
    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }
    
    .floating {
      animation: float 3s ease-in-out infinite;
    }
  </style>
  <style>body { box-sizing: border-box; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full m-0 overflow-auto">
  <div id="app-wrapper" class="min-h-full w-full bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex flex-col items-center justify-center p-4"><!-- Header -->
   <div class="text-center mb-6">
    <h1 id="game-title" class="text-4xl md:text-5xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 via-purple-400 to-pink-400 mb-2">ğŸ§  Ù„Ø¹Ø¨Ø© Ù†Ø¨Ø¶ Ø§Ù„Ø°Ø§ÙƒØ±Ø©</h1>
    <p class="text-slate-400 text-lg">ØªØ°ÙƒÙ‘Ø± Ø§Ù„ØªØ³Ù„Ø³Ù„ ÙˆÙƒØ±Ù‘Ø±Ù‡ Ø¨Ø§Ù„ØªØ±ØªÙŠØ¨!</p>
   </div><!-- Score & Level -->
   <div class="flex gap-6 mb-6">
    <div class="bg-slate-800/50 backdrop-blur-sm rounded-2xl px-6 py-3 border border-slate-700"><span class="text-slate-400 text-sm">Ø§Ù„Ù…Ø³ØªÙˆÙ‰</span>
     <p id="level-display" class="text-3xl font-bold text-cyan-400">1</p>
    </div>
    <div class="bg-slate-800/50 backdrop-blur-sm rounded-2xl px-6 py-3 border border-slate-700"><span class="text-slate-400 text-sm">Ø£Ø¹Ù„Ù‰ Ù†ØªÙŠØ¬Ø©</span>
     <p id="high-score" class="text-3xl font-bold text-pink-400">0</p>
    </div>
   </div><!-- Status Message -->
   <div id="status-container" class="mb-6 h-12 flex items-center justify-center">
    <p id="status-message" class="text-xl font-semibold text-white/90 floating">Ø§Ø¶ØºØ· Ø§Ø¨Ø¯Ø£ Ù„Ù„Ø¹Ø¨! ğŸ®</p>
   </div><!-- Game Grid -->
   <div id="game-grid" class="grid grid-cols-4 gap-3 mb-6 p-4 bg-slate-800/30 backdrop-blur-sm rounded-3xl border border-slate-700/50"><!-- Buttons will be generated here -->
   </div><!-- Start/Restart Button --> <button id="start-btn" class="px-10 py-4 bg-gradient-to-r from-cyan-500 to-purple-500 hover:from-cyan-400 hover:to-purple-400 text-white font-bold text-xl rounded-full shadow-lg shadow-purple-500/30 transition-all duration-300 hover:scale-105 active:scale-95"> ğŸš€ Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨Ø© </button> <!-- Instructions -->
   <div class="mt-6 text-center max-w-md">
    <p class="text-slate-500 text-sm">ğŸ‘€ Ø´Ø§Ù‡Ø¯ Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªÙŠ ØªÙ†Ø¨Ø¶ Ø«Ù… Ø£Ø¹Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„ÙŠÙ‡Ø§ Ø¨Ù†ÙØ³ Ø§Ù„ØªØ±ØªÙŠØ¨</p>
   </div>
  </div>
  <script>
    // Game Configuration
    const defaultConfig = {
      game_title: 'ğŸ§  Ù„Ø¹Ø¨Ø© Ù†Ø¨Ø¶ Ø§Ù„Ø°Ø§ÙƒØ±Ø©',
      start_button_text: 'ğŸš€ Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨Ø©',
      background_color: '#0f172a',
      button_color: '#334155',
      accent_color: '#06b6d4',
      text_color: '#f8fafc',
      highlight_color: '#a855f7'
    };

    let config = { ...defaultConfig };

    // Game State
    let sequence = [];
    let playerSequence = [];
    let level = 1;
    let highScore = 0;
    let isPlaying = false;
    let isShowingSequence = false;
    let canClick = false;

    // Button colors for visual variety
    const buttonColors = [
      { base: '#ef4444', glow: '#fca5a5' }, // Red
      { base: '#f97316', glow: '#fdba74' }, // Orange
      { base: '#eab308', glow: '#fde047' }, // Yellow
      { base: '#22c55e', glow: '#86efac' }, // Green
      { base: '#06b6d4', glow: '#67e8f9' }, // Cyan
      { base: '#3b82f6', glow: '#93c5fd' }, // Blue
      { base: '#8b5cf6', glow: '#c4b5fd' }, // Purple
      { base: '#ec4899', glow: '#f9a8d4' }, // Pink
      { base: '#14b8a6', glow: '#5eead4' }, // Teal
      { base: '#f43f5e', glow: '#fda4af' }, // Rose
      { base: '#84cc16', glow: '#bef264' }, // Lime
      { base: '#6366f1', glow: '#a5b4fc' }, // Indigo
      { base: '#0ea5e9', glow: '#7dd3fc' }, // Sky
      { base: '#d946ef', glow: '#e879f9' }, // Fuchsia
      { base: '#f59e0b', glow: '#fcd34d' }, // Amber
      { base: '#10b981', glow: '#6ee7b7' }  // Emerald
    ];

    // Initialize game grid
    function createGameGrid() {
      const grid = document.getElementById('game-grid');
      grid.innerHTML = '';
      
      for (let i = 0; i < 16; i++) {
        const btn = document.createElement('button');
        btn.id = `btn-${i}`;
        btn.className = 'game-btn w-16 h-16 md:w-20 md:h-20 rounded-2xl transition-all duration-150 disabled:opacity-50 disabled:cursor-not-allowed';
        btn.style.backgroundColor = buttonColors[i].base;
        btn.style.color = buttonColors[i].glow;
        btn.style.boxShadow = `0 4px 15px ${buttonColors[i].base}40`;
        btn.disabled = true;
        btn.onclick = () => handleButtonClick(i);
        grid.appendChild(btn);
      }
    }

    // Flash a button
    function flashButton(index, duration = 400) {
      return new Promise(resolve => {
        const btn = document.getElementById(`btn-${index}`);
        btn.classList.add('btn-pulse');
        btn.style.backgroundColor = buttonColors[index].glow;
        btn.style.boxShadow = `0 0 30px 10px ${buttonColors[index].glow}80`;
        
        setTimeout(() => {
          btn.classList.remove('btn-pulse');
          btn.style.backgroundColor = buttonColors[index].base;
          btn.style.boxShadow = `0 4px 15px ${buttonColors[index].base}40`;
          setTimeout(resolve, 100);
        }, duration);
      });
    }

    // Show sequence to player
    async function showSequence() {
      isShowingSequence = true;
      canClick = false;
      updateStatus('ğŸ‘€ Ø±Ø§Ù‚Ø¨ Ø§Ù„ØªØ³Ù„Ø³Ù„...', 'text-cyan-400');
      
      // Disable all buttons during sequence
      setButtonsEnabled(false);
      
      await sleep(500);
      
      for (let i = 0; i < sequence.length; i++) {
        await flashButton(sequence[i], Math.max(300, 500 - level * 20));
        await sleep(Math.max(100, 200 - level * 10));
      }
      
      isShowingSequence = false;
      canClick = true;
      setButtonsEnabled(true);
      updateStatus('ğŸ¯ Ø¯ÙˆØ±Ùƒ! ÙƒØ±Ø± Ø§Ù„ØªØ³Ù„Ø³Ù„', 'text-green-400');
    }

    // Add new item to sequence
    function addToSequence() {
      const newIndex = Math.floor(Math.random() * 16);
      sequence.push(newIndex);
    }

    // Handle player button click
    async function handleButtonClick(index) {
      if (!canClick || isShowingSequence) return;
      
      const btn = document.getElementById(`btn-${index}`);
      
      // Visual feedback
      await flashButton(index, 200);
      
      playerSequence.push(index);
      
      // Check if correct
      const currentIndex = playerSequence.length - 1;
      
      if (sequence[currentIndex] !== index) {
        // Wrong!
        await handleWrongAnswer();
        return;
      }
      
      // Correct so far
      btn.classList.add('btn-success');
      setTimeout(() => btn.classList.remove('btn-success'), 300);
      
      // Check if completed sequence
      if (playerSequence.length === sequence.length) {
        await handleCorrectSequence();
      }
    }

    // Handle wrong answer
    async function handleWrongAnswer() {
      canClick = false;
      setButtonsEnabled(false);
      
      updateStatus('âŒ Ø®Ø·Ø£! Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰', 'text-red-400');
      
      // Shake all buttons
      const buttons = document.querySelectorAll('.game-btn');
      buttons.forEach(btn => {
        btn.classList.add('btn-wrong');
        btn.style.backgroundColor = '#ef4444';
      });
      
      await sleep(500);
      
      buttons.forEach((btn, i) => {
        btn.classList.remove('btn-wrong');
        btn.style.backgroundColor = buttonColors[i].base;
      });
      
      // Update high score
      if (level - 1 > highScore) {
        highScore = level - 1;
        document.getElementById('high-score').textContent = highScore;
      }
      
      // Reset game
      await sleep(1000);
      resetGame();
      updateStatus('Ø§Ø¶ØºØ· Ø§Ø¨Ø¯Ø£ Ù„Ù„Ø¹Ø¨ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰! ğŸ”„', 'text-white/90');
      document.getElementById('start-btn').style.display = 'block';
    }

    // Handle correct sequence
    async function handleCorrectSequence() {
      canClick = false;
      setButtonsEnabled(false);
      
      level++;
      document.getElementById('level-display').textContent = level;
      
      updateStatus(`ğŸ‰ Ø£Ø­Ø³Ù†Øª! Ø§Ù„Ù…Ø³ØªÙˆÙ‰ ${level}`, 'text-green-400');
      
      // Flash all buttons in celebration
      const buttons = document.querySelectorAll('.game-btn');
      buttons.forEach((btn, i) => {
        setTimeout(() => {
          btn.style.backgroundColor = buttonColors[i].glow;
          setTimeout(() => {
            btn.style.backgroundColor = buttonColors[i].base;
          }, 200);
        }, i * 50);
      });
      
      await sleep(1500);
      
      // Next round
      playerSequence = [];
      addToSequence();
      await showSequence();
    }

    // Enable/disable buttons
    function setButtonsEnabled(enabled) {
      const buttons = document.querySelectorAll('.game-btn');
      buttons.forEach(btn => btn.disabled = !enabled);
    }

    // Update status message
    function updateStatus(message, colorClass = 'text-white/90') {
      const statusEl = document.getElementById('status-message');
      statusEl.textContent = message;
      statusEl.className = `text-xl font-semibold ${colorClass}`;
    }

    // Reset game state
    function resetGame() {
      sequence = [];
      playerSequence = [];
      level = 1;
      isPlaying = false;
      canClick = false;
      document.getElementById('level-display').textContent = '1';
      setButtonsEnabled(false);
    }

    // Start game
    async function startGame() {
      document.getElementById('start-btn').style.display = 'none';
      resetGame();
      isPlaying = true;
      
      updateStatus('ğŸ¬ Ø§Ø³ØªØ¹Ø¯...', 'text-yellow-400');
      await sleep(1000);
      
      addToSequence();
      await showSequence();
    }

    // Utility function
    function sleep(ms) {
      return new Promise(resolve => setTimeout(resolve, ms));
    }

    // Apply config to UI
    function applyConfig(cfg) {
      document.getElementById('game-title').textContent = cfg.game_title || defaultConfig.game_title;
      document.getElementById('start-btn').textContent = cfg.start_button_text || defaultConfig.start_button_text;
    }

    // Initialize
    function init() {
      createGameGrid();
      
      document.getElementById('start-btn').addEventListener('click', startGame);
      
      // Initialize Element SDK
      if (window.elementSdk) {
        window.elementSdk.init({
          defaultConfig,
          onConfigChange: async (newConfig) => {
            config = { ...defaultConfig, ...newConfig };
            applyConfig(config);
          },
          mapToCapabilities: (cfg) => ({
            recolorables: [],
            borderables: [],
            fontEditable: undefined,
            fontSizeable: undefined
          }),
          mapToEditPanelValues: (cfg) => new Map([
            ['game_title', cfg.game_title || defaultConfig.game_title],
            ['start_button_text', cfg.start_button_text || defaultConfig.start_button_text]
          ])
        });
      }
      
      applyConfig(config);
    }

    init();
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9cdfc234e68ec6e8',t:'MTc3MTEwNTU5MC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>